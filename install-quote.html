<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CWF - ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏£‡πå</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="/mainfest.json">
  <meta name="theme-color" content="#0b4bb3">
  <style>
    /* page-local premium tweaks (no regression to other pages) */
    .iq-wrap{max-width:980px;margin:0 auto;}
    .iq-steps{display:flex;flex-direction:column;gap:12px;}
    .iq-step{border:1px solid rgba(255,255,255,.08);}
    .iq-step h2{margin:0 0 10px 0;font-size:18px;}
    .iq-grid{display:grid;grid-template-columns:1fr;gap:10px;}
    .iq-grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
    .iq-chiprow{display:flex;flex-wrap:wrap;gap:8px;}
    .iq-chip{border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:#fff;padding:10px 12px;border-radius:999px;font-weight:700;font-size:14px;cursor:pointer;user-select:none;}
    .iq-chip[aria-pressed="true"]{background:rgba(11,75,179,.35);border-color:rgba(58,140,255,.65);box-shadow:0 8px 22px rgba(0,0,0,.18) inset;}
    .iq-sub{color:rgba(255,255,255,.78);font-size:12px;line-height:1.35;}
    .iq-badge{display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border-radius:12px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);}
    .iq-badge b{font-size:14px;}
    .iq-kpi{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
    .iq-kpi .k{padding:12px;border-radius:14px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);}
    .iq-kpi .k .t{font-size:12px;color:rgba(255,255,255,.72)}
    .iq-kpi .k .v{margin-top:6px;font-size:18px;font-weight:900}
    .iq-table{width:100%;border-collapse:collapse;}
    .iq-table td{padding:8px 6px;border-bottom:1px solid rgba(255,255,255,.08);vertical-align:top;}
    .iq-table td:last-child{text-align:right;font-weight:800}
    .iq-hr{height:1px;background:rgba(255,255,255,.10);margin:10px 0;}
    .iq-actions{display:flex;gap:10px;flex-wrap:wrap;}
    .iq-actions .primary{flex:1;min-width:180px;}
    .iq-actions .secondary{flex:1;min-width:180px;}
    .iq-note{padding:12px;border-radius:14px;background:rgba(255,196,0,.12);border:1px solid rgba(255,196,0,.22);}
    .iq-note b{color:#ffe38a;}
    .iq-error{display:none;margin-top:10px;padding:10px 12px;border-radius:12px;background:rgba(255,59,59,.12);border:1px solid rgba(255,59,59,.25);}
    .iq-error.show{display:block;}
    .iq-muted{color:rgba(255,255,255,.72)}
    @media (min-width: 860px){
      .iq-grid2{grid-template-columns:1fr 1fr;}
      .iq-kpi{grid-template-columns:1fr 1fr 1fr 1fr;}
    }
  </style>
</head>
<body class="theme-2">
  <div class="app">
    <div class="topbar">
      <div class="brand">
        <img src="/logo.png" alt="CWF">
        <div class="title">
          <b>üßÆ ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏£‡πå (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</b>
          <span class="muted">Coldwindflow air services</span>
        </div>
      </div>
      <div class="top-actions">
        <button class="secondary" type="button" onclick="location.href='/customer'">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏á‡∏Ñ‡∏¥‡∏ß</button>
        <button class="secondary top-track" type="button" onclick="location.href='/track.html'">üîé ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏á‡∏≤‡∏ô</button>
      </div>
    </div>

    <div class="iq-wrap" style="padding:14px 14px 28px;">
      <div class="card iq-step">
        <div class="iq-kpi">
          <div class="k">
            <div class="t">‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</div>
            <div id="kpi_per" class="v">-</div>
          </div>
          <div class="k">
            <div class="t">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            <div id="kpi_grand" class="v">-</div>
          </div>
          <div class="k">
            <div class="t">BTU ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</div>
            <div id="kpi_btu" class="v">-</div>
          </div>
          <div class="k">
            <div class="t">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</div>
            <div id="kpi_count" class="v">1</div>
          </div>
        </div>
        <div class="iq-sub" style="margin-top:10px;">* ‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‚Äù ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡∏´‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏à‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
      </div>

      <div class="iq-steps">
        <div class="card iq-step">
          <h2>Step 1: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏≠‡∏£‡πå</h2>
          <div class="iq-chiprow" role="group" aria-label="ac type">
            <button class="iq-chip" type="button" data-ac-type="‡∏ï‡∏¥‡∏î‡∏ú‡∏ô‡∏±‡∏á" aria-pressed="true">‡∏ï‡∏¥‡∏î‡∏ú‡∏ô‡∏±‡∏á</button>
            <button class="iq-chip" type="button" data-ac-type="‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏Ç‡∏ß‡∏ô" aria-pressed="false">‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏Ç‡∏ß‡∏ô</button>
          </div>
        </div>

        <div class="card iq-step">
          <h2>Step 2: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</h2>
          <div class="iq-grid" style="align-items:start;">
            <div class="machine-box" style="max-width:360px;">
              <div class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</div>
              <input id="machine_count" type="hidden" value="1">
              <div class="stepper" aria-label="machine count" style="margin-top:8px;">
                <button id="mc_minus" class="btn-round" type="button" aria-label="‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô">‚àí</button>
                <div id="mc_value" class="value">1</div>
                <button id="mc_plus" class="btn-round" type="button" aria-label="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô">+</button>
              </div>
              <div class="iq-sub" style="margin-top:8px;">* ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏π‡∏ì ‚Äú‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‚Äù ‡πÄ‡∏õ‡πá‡∏ô ‚Äú‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‚Äù ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
            </div>
          </div>
        </div>

        <div class="card iq-step">
          <h2>Step 3: BTU</h2>
          <div class="iq-grid">
            <div class="iq-chiprow" role="group" aria-label="btu mode">
              <button class="iq-chip" type="button" data-btu-mode="manual" aria-pressed="true">‡∏Å‡∏£‡∏≠‡∏Å BTU ‡πÄ‡∏≠‡∏á</button>
              <button class="iq-chip" type="button" data-btu-mode="room" aria-pressed="false">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡πâ‡∏≠‡∏á</button>
            </div>

            <div id="btu_manual_box" class="iq-grid2" style="margin-top:6px;">
              <div>
                <div class="label">BTU</div>
                <input id="btu_input" inputmode="numeric" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12000" />
                <div class="iq-sub" style="margin-top:6px;">* ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ BTU ‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏ó‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô</div>
              </div>
              <div>
                <div class="label">‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô BTU ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</div>
                <div class="iq-badge" style="margin-top:8px;">
                  <span class="iq-muted">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</span>
                  <b id="btu_norm_badge">-</b>
                </div>
                <button id="use_norm_btu" class="secondary" type="button" style="margin-top:10px;">‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ BTU ‡∏ô‡∏µ‡πâ</button>
              </div>
            </div>

            <div id="btu_room_box" class="iq-grid" style="display:none;margin-top:6px;">
              <div class="iq-grid2">
                <div>
                  <div class="label">‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡πâ‡∏≠‡∏á (‡∏ï‡∏£.‡∏°.)</div>
                  <input id="room_area" inputmode="decimal" placeholder="‡πÄ‡∏ä‡πà‡∏ô 20" />
                </div>
                <div>
                  <div class="label">‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏´‡πâ‡∏≠‡∏á</div>
                  <select id="room_factor">
                    <option value="700">‡∏õ‡∏Å‡∏ï‡∏¥</option>
                    <option value="800">‡πÇ‡∏î‡∏ô‡πÅ‡∏î‡∏î/‡∏´‡πâ‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏ô</option>
                    <option value="900">‡πÄ‡∏û‡∏î‡∏≤‡∏ô‡∏™‡∏π‡∏á/‡∏Ñ‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞</option>
                  </select>
                </div>
              </div>

              <div class="iq-note" style="margin-top:8px;">
                <div><b>BTU ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</b> (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà √ó ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢)</div>
                <div style="margin-top:8px;display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
                  <div class="iq-badge"><span class="iq-muted">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ:</span><b id="btu_raw">-</b></div>
                  <div class="iq-badge"><span class="iq-muted">‡∏õ‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô:</span><b id="btu_norm">-</b></div>
                  <button id="use_room_btu" class="primary" type="button">‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ BTU ‡∏ô‡∏µ‡πâ</button>
                </div>
              </div>
            </div>

            <div id="btu_warn" class="iq-error">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà BTU (‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äú‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ BTU ‡∏ô‡∏µ‡πâ‚Äù)</div>
          </div>
        </div>

        <div class="card iq-step">
          <h2>Step 4: ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡πà‡∏≠‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</h2>
          <div class="iq-sub">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡∏¥‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‚Äú‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‚Äù (‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡∏≤ 4m / ‡∏™‡∏≤‡∏¢‡πÑ‡∏ü 8m / ‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ó‡∏¥‡πâ‡∏á 8m / ‡∏£‡∏≤‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ó‡πà‡∏≠ 4m)</div>
          <div class="iq-grid2" style="margin-top:10px;">
            <div>
              <div class="label">‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡∏≤ (m)</div>
              <input id="len_ref" inputmode="decimal" placeholder="‡πÄ‡∏ä‡πà‡∏ô 6" />
            </div>
            <div>
              <div class="label">‡∏™‡∏≤‡∏¢‡πÑ‡∏ü (m)</div>
              <input id="len_power" inputmode="decimal" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12" />
            </div>
            <div>
              <div class="label">‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ó‡∏¥‡πâ‡∏á (m)</div>
              <input id="len_drain" inputmode="decimal" placeholder="‡πÄ‡∏ä‡πà‡∏ô 10" />
              <div class="iq-sub" style="margin-top:6px;">* ‡πÄ‡∏Å‡∏¥‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‚Äú‡πÑ‡∏°‡πà‡∏Ñ‡∏¥‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‚Äù (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏£‡∏ó)</div>
            </div>
            <div>
              <div class="label">‡∏£‡∏≤‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ó‡πà‡∏≠ (m)</div>
              <input id="len_trunk" inputmode="decimal" placeholder="‡πÄ‡∏ä‡πà‡∏ô 6" />
            </div>
          </div>
        </div>

        <div class="card iq-step">
          <h2>Step 5: ‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏û‡∏¥‡πà‡∏° (‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</h2>
          <div class="iq-grid">
            <div class="iq-grid2">
              <div>
                <label style="display:flex;gap:10px;align-items:center;">
                  <input id="chk_wall_chase" type="checkbox" style="transform:scale(1.2);">
                  <b>‡∏Å‡∏£‡∏µ‡∏î‡∏ú‡∏ô‡∏±‡∏á‡∏ù‡∏±‡∏á‡∏ó‡πà‡∏≠</b>
                </label>
                <input id="wall_chase_m" inputmode="decimal" placeholder="‡πÄ‡∏°‡∏ï‡∏£" disabled>
                <div class="iq-sub">300 ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏°‡∏ï‡∏£</div>
              </div>

              <div>
                <label style="display:flex;gap:10px;align-items:center;">
                  <input id="chk_ceiling_run" type="checkbox" style="transform:scale(1.2);">
                  <b>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡πà‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡∏ù‡πâ‡∏≤</b>
                </label>
                <input id="ceiling_run_m" inputmode="decimal" placeholder="‡πÄ‡∏°‡∏ï‡∏£" disabled>
                <div class="iq-sub">300 ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏°‡∏ï‡∏£</div>
              </div>
            </div>

            <div class="iq-grid2">
              <div>
                <label style="display:flex;gap:10px;align-items:center;">
                  <input id="chk_thick_insulation" type="checkbox" style="transform:scale(1.2);" disabled>
                  <b>‡∏â‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏ù‡πâ‡∏≤)</b>
                </label>
                <input id="thick_insulation_m" inputmode="decimal" placeholder="‡πÄ‡∏°‡∏ï‡∏£" disabled>
                <div class="iq-sub">200 ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏°‡∏ï‡∏£</div>
              </div>

              <div>
                <label style="display:flex;gap:10px;align-items:center;">
                  <input id="chk_misc_parts" type="checkbox" style="transform:scale(1.2);">
                  <b>‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏™‡∏£‡∏¥‡∏°</b>
                </label>
                <input id="misc_parts_qty" inputmode="numeric" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏¥‡πâ‡∏ô" disabled>
                <div class="iq-sub">100 ‡∏ö‡∏≤‡∏ó/‡∏ä‡∏¥‡πâ‡∏ô</div>
              </div>
            </div>

            <div class="iq-grid2">
              <div>
                <label style="display:flex;gap:10px;align-items:center;">
                  <input id="chk_wire_tray" type="checkbox" style="transform:scale(1.2);">
                  <b>‡∏£‡∏≤‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏™‡∏≤‡∏¢‡πÑ‡∏ü</b>
                </label>
                <input id="wire_tray_m" inputmode="decimal" placeholder="‡πÄ‡∏°‡∏ï‡∏£" disabled>
                <div class="iq-sub">50 ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏°‡∏ï‡∏£</div>
              </div>
              <div>
                <label style="display:flex;gap:10px;align-items:center;">
                  <input id="chk_pvc" type="checkbox" style="transform:scale(1.2);">
                  <b>‡∏ó‡πà‡∏≠ PVC ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß</b>
                </label>
                <input id="pvc_m" inputmode="decimal" placeholder="‡πÄ‡∏°‡∏ï‡∏£" disabled>
                <div class="iq-sub">70 ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏°‡∏ï‡∏£</div>
              </div>
            </div>

            <div class="iq-grid2">
              <div>
                <div class="label">‡∏ï‡∏±‡πâ‡∏á‡∏ô‡∏±‡πà‡∏á‡∏£‡πâ‡∏≤‡∏ô</div>
                <select id="scaffold">
                  <option value="none">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ</option>
                  <option value="3-5">‡∏™‡∏π‡∏á 3‚Äì5 ‡πÄ‡∏°‡∏ï‡∏£ (1,000)</option>
                  <option value="6-8">‡∏™‡∏π‡∏á 6‚Äì8 ‡πÄ‡∏°‡∏ï‡∏£ (2,000)</option>
                </select>
              </div>
              <div>
                <div class="label">‡∏Å‡∏£‡∏¥‡∏ß‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏•‡∏°</div>
                <select id="grill">
                  <option value="none">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ</option>
                  <option value="small">‡πÄ‡∏•‡πá‡∏Å (1,200)</option>
                  <option value="medium">‡∏Å‡∏•‡∏≤‡∏á (1,500)</option>
                  <option value="large1800">‡πÉ‡∏´‡∏ç‡πà (1,800)</option>
                  <option value="large2000">‡πÉ‡∏´‡∏ç‡πà (2,000)</option>
                </select>
              </div>
            </div>

            <div class="iq-grid2">
              <div>
                <div class="label">‡∏Å‡∏≤‡∏•‡∏±‡∏Å‡∏ô‡πâ‡∏≥</div>
                <select id="siphon">
                  <option value="none">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ</option>
                  <option value="auto">‡∏ï‡∏≤‡∏° BTU</option>
                </select>
                <div class="iq-sub">9,000‚Äì24,000 = 2,500 | 30,000‚Äì60,000 = 4,000</div>
              </div>
            </div>
          </div>
        </div>

        <div class="card iq-step">
          <h2>Result: Breakdown</h2>
          <div id="result_box">
            <div class="iq-sub">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</div>
          </div>
          <div class="iq-actions" style="margin-top:12px;">
            <button id="btn_copy" class="primary" type="button">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ</button>
            <button id="btn_reset" class="secondary" type="button">üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</button>
          </div>
          <div id="copy_status" class="iq-sub" style="margin-top:10px;display:none;"></div>
        </div>

        <div class="card iq-step">
          <h2>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h2>
          <ul style="margin:0;padding-left:18px;line-height:1.6;color:rgba(255,255,255,.9);">
            <li>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡∏ï‡∏±‡∏î‡∏ó‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÑ‡∏î‡πâ</li>
            <li>‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏¢‡∏•‡πå‡∏£‡πâ‡∏≠‡∏ô‡πÑ‡∏õ‡∏Ñ‡∏≠‡∏¢‡∏•‡πå‡πÄ‡∏¢‡πá‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏ü‡πÄ‡∏°‡∏ô‡∏à‡∏≤‡∏Å‡∏ï‡∏π‡πâ‡πÑ‡∏ü‡∏´‡∏•‡∏±‡∏Å)</li>
            <li>‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≥‡∏¢‡∏≤ ‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script src="/assets/js/install_quote.js"></script>
  <script>
    (function(){
      "use strict";
      const $ = (id)=>document.getElementById(id);
      const fmt = (n)=> (Number.isFinite(Number(n)) ? Number(n).toLocaleString('th-TH') : '-');
      const money = (n)=> (Number.isFinite(Number(n)) ? Math.round(Number(n)).toLocaleString('th-TH') : '-');
      const qty = (n)=>{
        try{
          if(window.InstallQuote && InstallQuote._fmt && typeof InstallQuote._fmt.formatQty==='function'){
            return InstallQuote._fmt.formatQty(n,'m');
          }
          return String(n||0);
        }catch(e){ return String(n||0); }
      };

      let state = {
        ac_type: '‡∏ï‡∏¥‡∏î‡∏ú‡∏ô‡∏±‡∏á',
        btu_mode: 'manual',
        btu: 0,
      };

      // chips
      document.querySelectorAll('[data-ac-type]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const v = btn.getAttribute('data-ac-type');
          state.ac_type = v;
          document.querySelectorAll('[data-ac-type]').forEach(b=>b.setAttribute('aria-pressed', String(b===btn)));
          recalc();
        });
      });

      document.querySelectorAll('[data-btu-mode]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const v = btn.getAttribute('data-btu-mode');
          state.btu_mode = v;
          document.querySelectorAll('[data-btu-mode]').forEach(b=>b.setAttribute('aria-pressed', String(b===btn)));
          $('btu_manual_box').style.display = (v==='manual') ? '' : 'none';
          $('btu_room_box').style.display = (v==='room') ? '' : 'none';
          $('btu_warn').classList.remove('show');
          recalc();
        });
      });

      // machine count stepper
      const setCount = (n)=>{
        const v = Math.max(1, Math.min(50, parseInt(n||'1',10)||1));
        $('machine_count').value = String(v);
        $('mc_value').textContent = String(v);
        $('kpi_count').textContent = String(v);
        recalc();
      };
      $('mc_minus').addEventListener('click', ()=> setCount((parseInt($('machine_count').value,10)||1)-1));
      $('mc_plus').addEventListener('click', ()=> setCount((parseInt($('machine_count').value,10)||1)+1));

      // special toggles
      const bindToggle = (chkId, inputId)=>{
        const chk = $(chkId);
        const inp = $(inputId);
        chk.addEventListener('change', ()=>{
          inp.disabled = !chk.checked;
          if(!chk.checked) inp.value = '';
          recalc();
        });
        inp.addEventListener('input', recalc);
      };
      bindToggle('chk_wall_chase','wall_chase_m');
      bindToggle('chk_ceiling_run','ceiling_run_m');
      bindToggle('chk_misc_parts','misc_parts_qty');
      bindToggle('chk_wire_tray','wire_tray_m');
      bindToggle('chk_pvc','pvc_m');

      // thick insulation depends on ceiling run
      const syncInsulation = ()=>{
        const ceilingOn = $('chk_ceiling_run').checked;
        $('chk_thick_insulation').disabled = !ceilingOn;
        if(!ceilingOn){
          $('chk_thick_insulation').checked = false;
          $('thick_insulation_m').value = '';
          $('thick_insulation_m').disabled = true;
        } else {
          $('thick_insulation_m').disabled = !$('chk_thick_insulation').checked;
        }
      };
      $('chk_ceiling_run').addEventListener('change', ()=>{ syncInsulation(); recalc(); });
      $('chk_thick_insulation').addEventListener('change', ()=>{ $('thick_insulation_m').disabled = !$('chk_thick_insulation').checked; if(!$('chk_thick_insulation').checked) $('thick_insulation_m').value=''; recalc(); });
      $('thick_insulation_m').addEventListener('input', recalc);
      syncInsulation();

      // standard inputs
      ['btu_input','len_ref','len_power','len_drain','len_trunk','room_area'].forEach(id=>$(id).addEventListener('input', recalc));
      $('room_factor').addEventListener('change', recalc);
      ['scaffold','grill','siphon'].forEach(id=>$(id).addEventListener('change', recalc));

      // btu normalize helpers
      function setBtuValue(btu){
        const v = Math.max(0, Math.min(200000, parseInt(btu||'0',10)||0));
        state.btu = v;
        $('kpi_btu').textContent = v ? fmt(v) : '-';
      }

      $('use_norm_btu').addEventListener('click', ()=>{
        const raw = InstallQuote._util.toNumber($('btu_input').value, {min:0,max:200000,decimals:0});
        const norm = InstallQuote.normalizeBtu(raw);
        $('btu_input').value = norm ? String(norm) : '';
        setBtuValue(norm);
        $('btu_warn').classList.remove('show');
        recalc();
      });

      $('use_room_btu').addEventListener('click', ()=>{
        const area = InstallQuote._util.toNumber($('room_area').value, {min:0,max:1000,decimals:2});
        const factor = InstallQuote._util.toNumber($('room_factor').value, {min:700,max:900,decimals:0});
        const r = InstallQuote.calcBtuFromRoom(area, factor);
        if(r.normalized_btu){
          $('btu_input').value = String(r.normalized_btu);
          setBtuValue(r.normalized_btu);
          $('btu_warn').classList.remove('show');
        }
        recalc();
      });

      function buildBreakdownHtml(b){
        const per = money(b.totals.per_machine);
        const grand = money(b.totals.grand);
        $('kpi_per').textContent = per==='-'? '-' : per + ' ‡∏ø';
        $('kpi_grand').textContent = grand==='-'? '-' : grand + ' ‡∏ø';

        const extrasRows = b.extras.lines.map(x=>{
          if(x.key==='drain'){
            const extraTxt = x.extra_m>0 ? `‡πÄ‡∏Å‡∏¥‡∏ô ${qty(x.extra_m)}m` : '‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô';
            return `<tr><td>${x.label}<div class="iq-sub">${extraTxt} ‚Ä¢ ${x.note}</div></td><td>${money(0)} ‡∏ø</td></tr>`;
          }
          const extraTxt = x.extra_m>0 ? `‡πÄ‡∏Å‡∏¥‡∏ô ${qty(x.extra_m)}m x ${money(x.rate)}/m` : '‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô (0 ‡∏ö‡∏≤‡∏ó)';
          return `<tr><td>${x.label}<div class="iq-sub">${extraTxt}</div></td><td>${money(x.cost)} ‡∏ø</td></tr>`;
        }).join('');

        const fmtQtyUnit = (v,u)=>{
          try{
            if(window.InstallQuote && InstallQuote._fmt && typeof InstallQuote._fmt.formatQty==='function'){
              return InstallQuote._fmt.formatQty(v,u);
            }
            return String(v||0);
          }catch(e){ return String(v||0); }
        };

        const specialsRows = (b.specials.lines.length?
          b.specials.lines.map(s=>`<tr><td>${s.label}<div class="iq-sub">${fmtQtyUnit(s.qty,s.unit)}${s.unit} x ${money(s.rate)}</div></td><td>${money(s.cost)} ‡∏ø</td></tr>`).join('')
          : `<tr><td class="iq-muted">‡πÑ‡∏°‡πà‡∏°‡∏µ</td><td>${money(0)} ‡∏ø</td></tr>`
        );

        return `
          <div class="iq-grid" style="gap:8px;">
            <div class="iq-badge"><span class="iq-muted">‡πÄ‡∏£‡∏ó‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡∏≤/‡∏™‡∏≤‡∏¢‡πÑ‡∏ü‡∏ï‡∏≤‡∏° BTU:</span><b>‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡∏≤ ${money(b.meta.rates.ref_per_m)}/m ‚Ä¢ ‡∏™‡∏≤‡∏¢‡πÑ‡∏ü ${money(b.meta.rates.power_per_m)}/m</b></div>
            <div class="iq-hr"></div>
            <div><b>1) ‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</b><div class="iq-sub">‡∏ä‡πà‡∏ß‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤ ${b.base_labor.range_label} ‡∏ö‡∏≤‡∏ó ‚Ä¢ ‡πÉ‡∏ä‡πâ STD = <b>${money(b.base_labor.std)}</b> ‡∏ö‡∏≤‡∏ó/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</div></div>
            <table class="iq-table"><tr><td>‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á (STD)</td><td>${money(b.base_labor.std)} ‡∏ø</td></tr></table>

            <div class="iq-hr"></div>
            <div><b>2) ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß/‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</b>
              <div class="iq-sub">‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏¢‡∏≤ 4m ‚Ä¢ ‡∏™‡∏≤‡∏¢‡πÑ‡∏ü 8m ‚Ä¢ ‡∏ó‡πà‡∏≠‡∏ô‡πâ‡∏≥‡∏ó‡∏¥‡πâ‡∏á 8m ‚Ä¢ ‡πÄ‡∏ö‡∏£‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå 1 ‡∏ä‡∏∏‡∏î ‚Ä¢ ‡∏£‡∏≤‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ó‡πà‡∏≠ 4m ‚Ä¢ ‡∏Ç‡∏≤‡∏¢‡∏≤‡∏á‡∏£‡∏≠‡∏á/‡∏Ç‡∏≤‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</div>
            </div>

            <div class="iq-hr"></div>
            <div><b>3) ‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</b></div>
            <table class="iq-table">${extrasRows}<tr><td><b>‡∏£‡∏ß‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô</b></td><td><b>${money(b.extras.total)} ‡∏ø</b></td></tr></table>

            <div class="iq-hr"></div>
            <div><b>4) ‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°</b></div>
            <table class="iq-table">${specialsRows}<tr><td><b>‡∏£‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©</b></td><td><b>${money(b.specials.total)} ‡∏ø</b></td></tr></table>

            <div class="iq-hr"></div>
            <table class="iq-table">
              <tr><td><b>5) ‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</b></td><td><b>${money(b.totals.per_machine)} ‡∏ø</b></td></tr>
              <tr><td><b>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (${fmt(b.meta.machine_count)} ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</b></td><td><b>${money(b.totals.grand)} ‡∏ø</b></td></tr>
            </table>
          </div>
        `;
      }

      function gather(){
        const machine_count = parseInt($('machine_count').value,10)||1;
        const btuManual = InstallQuote._util.toNumber($('btu_input').value, {min:0,max:200000,decimals:0});
        setBtuValue(btuManual);

        return {
          ac_type: state.ac_type,
          machine_count,
          btu: state.btu,
          len_ref: $('len_ref').value,
          len_power: $('len_power').value,
          len_drain: $('len_drain').value,
          len_trunk: $('len_trunk').value,
          wall_chase_m: $('chk_wall_chase').checked ? $('wall_chase_m').value : 0,
          ceiling_run_m: $('chk_ceiling_run').checked ? $('ceiling_run_m').value : 0,
          thick_insulation_m: ($('chk_ceiling_run').checked && $('chk_thick_insulation').checked) ? $('thick_insulation_m').value : 0,
          misc_parts_qty: $('chk_misc_parts').checked ? $('misc_parts_qty').value : 0,
          wire_tray_m: $('chk_wire_tray').checked ? $('wire_tray_m').value : 0,
          pvc_m: $('chk_pvc').checked ? $('pvc_m').value : 0,
          scaffold: $('scaffold').value,
          grill: $('grill').value,
          siphon: $('siphon').value,
        };
      }

      function updateBtuBadges(){
        const raw = InstallQuote._util.toNumber($('btu_input').value, {min:0,max:200000,decimals:0});
        const norm = InstallQuote.normalizeBtu(raw);
        $('btu_norm_badge').textContent = norm ? fmt(norm) : '-';

        const area = InstallQuote._util.toNumber($('room_area').value, {min:0,max:1000,decimals:2});
        const factor = InstallQuote._util.toNumber($('room_factor').value, {min:700,max:900,decimals:0});
        const r = InstallQuote.calcBtuFromRoom(area, factor);
        $('btu_raw').textContent = r.raw_btu ? fmt(r.raw_btu) : '-';
        $('btu_norm').textContent = r.normalized_btu ? fmt(r.normalized_btu) : '-';
      }

      let lastBreakdown = null;

      function recalc(){
        updateBtuBadges();
        const input = gather();
        // KPI BTU will be updated again after calcQuote() (uses normalized BTU for pricing)
        $('kpi_btu').textContent = input.btu ? fmt(input.btu) : '-';

        // validation
        if(!input.btu){
          $('btu_warn').classList.add('show');
          $('result_box').innerHTML = '<div class="iq-sub">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà BTU ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤</div>';
          $('kpi_per').textContent = '-';
          $('kpi_grand').textContent = '-';
          lastBreakdown = null;
          return;
        }
        $('btu_warn').classList.remove('show');

        const b = InstallQuote.calcQuote(input);
        lastBreakdown = b;
        // Show BTU that is actually used for calculation (normalized)
        if (b && b.meta && b.meta.btu_used) {
          $('kpi_btu').textContent = fmt(b.meta.btu_used);
        }
        $('result_box').innerHTML = buildBreakdownHtml(b);
      }

      async function copyText(text){
        // robust clipboard with fallback
        try{
          if(navigator.clipboard && window.isSecureContext){
            await navigator.clipboard.writeText(text);
            return true;
          }
        }catch(e){/* fall through */}
        try{
          const ta = document.createElement('textarea');
          ta.value = text;
          ta.setAttribute('readonly','');
          ta.style.position='fixed';
          ta.style.top='-9999px';
          document.body.appendChild(ta);
          ta.select();
          const ok = document.execCommand('copy');
          document.body.removeChild(ta);
          return !!ok;
        }catch(e){
          return false;
        }
      }

      $('btn_copy').addEventListener('click', async ()=>{
        const box = $('copy_status');
        if(!lastBreakdown){
          box.style.display='block';
          box.textContent='‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å BTU ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)';
          return;
        }
        const text = InstallQuote.formatQuoteForCopy(lastBreakdown);
        const ok = await copyText(text);
        box.style.display='block';
        box.textContent = ok ? '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß (‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡πÅ‡∏ä‡∏ó/‡πÑ‡∏•‡∏ô‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)' : '‚ùå ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å)';
      });

      $('btn_reset').addEventListener('click', ()=>{
        // keep safe: only reset fields in this page
        state.ac_type = '‡∏ï‡∏¥‡∏î‡∏ú‡∏ô‡∏±‡∏á';
        state.btu_mode = 'manual';
        state.btu = 0;

        // chips reset
        document.querySelectorAll('[data-ac-type]').forEach(b=>b.setAttribute('aria-pressed', String(b.getAttribute('data-ac-type')==='‡∏ï‡∏¥‡∏î‡∏ú‡∏ô‡∏±‡∏á')));
        document.querySelectorAll('[data-btu-mode]').forEach(b=>b.setAttribute('aria-pressed', String(b.getAttribute('data-btu-mode')==='manual')));
        $('btu_manual_box').style.display='';
        $('btu_room_box').style.display='none';
        setCount(1);

        ['btu_input','len_ref','len_power','len_drain','len_trunk','room_area','wall_chase_m','ceiling_run_m','thick_insulation_m','misc_parts_qty','wire_tray_m','pvc_m'].forEach(id=>{ $(id).value=''; });
        ['chk_wall_chase','chk_ceiling_run','chk_thick_insulation','chk_misc_parts','chk_wire_tray','chk_pvc'].forEach(id=>{ $(id).checked=false; });
        ['scaffold','grill','siphon'].forEach(id=>{ $(id).value='none'; });
        ['wall_chase_m','ceiling_run_m','thick_insulation_m','misc_parts_qty','wire_tray_m','pvc_m'].forEach(id=>{ $(id).disabled=true; });
        syncInsulation();
        $('copy_status').style.display='none';
        $('btu_warn').classList.remove('show');
        recalc();
      });

      // initial paint
      setCount(1);
      recalc();
    })();
  </script>
</body>
</html>
