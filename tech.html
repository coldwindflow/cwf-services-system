<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á - CWF</title>
  <link rel="stylesheet" href="style.css">

  <style>
    .tabs { display:flex; gap:10px; }
    .tab-btn{
      flex:1; min-height: 44px; border-radius: 14px;
      border: 1px solid rgba(15,23,42,0.10);
      background: rgba(37,99,235,0.08);
      color: #2563eb; font-weight: 800; box-shadow: none;
    }
    .tab-btn.active{
      background: linear-gradient(135deg, #2563eb, #06b6d4);
      color: #fff; border: none; box-shadow: var(--shadow-2);
    }

    .section{ display:none; }
    .section.active{ display:block; }

    /* ‚úÖ bottom bar ‡∏•‡πá‡∏≠‡∏Ñ‡∏ï‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏á‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .bottom-nav{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 0;
      width: min(460px, calc(100% - 28px));
      z-index: 999;
      display:flex;
      gap:10px;
      padding: 10px;
      border-radius: 18px 18px 0 0;
      border: 1px solid rgba(15,23,42,0.10);
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
    }

    /* ‚úÖ ‡∏Å‡∏±‡∏ô content ‡πÇ‡∏î‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏±‡∏ö */
    .app{ padding-bottom: 110px; }

    .nav-btn{
      flex:1; min-height: 44px; border-radius: 14px;
      border: 1px solid rgba(15,23,42,0.10);
      background: rgba(15,23,42,0.04);
      color: #0f172a; font-weight: 800; box-shadow:none;
      padding: 10px 8px; font-size: 12px;
    }
    .nav-btn.active{
      background: rgba(37,99,235,0.12);
      color: #2563eb;
      border-color: rgba(37,99,235,0.25);
    }

    /* ‚úÖ ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ä‡πà‡∏≤‡∏á: ‡∏£‡∏π‡∏õ + ‡∏ä‡∏∑‡πà‡∏≠ + (‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥)
       - align-items:flex-start ‡∏Å‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠/‡πÅ‡∏£‡∏á‡∏Ñ‡πå‡∏î‡∏π‡∏ï‡πà‡∏≥‡πÄ‡∏ß‡∏•‡∏≤‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ï‡πâ‡∏£‡∏π‡∏õ
       - flex-wrap ‡∏Å‡∏±‡∏ô‡∏•‡πâ‡∏ô‡∏à‡∏≠‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .profile-box{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin: 6px 0 12px;
      flex-wrap: wrap;
    }
    .profile-left{
      display:flex;
      align-items:flex-start;
      gap:12px;
      min-width: 0;
      flex: 1 1 260px;
    }
    .tech-avatar{
      width:56px;
      height:56px;
      border-radius: 999px;
      border: 3px solid rgba(37,99,235,0.25);
      object-fit: cover;
      background:#fff;
    }
    .profile-meta{ padding-top: 2px; min-width:0; }
    .profile-meta b{ font-size:20px; line-height:1.15; display:block; }
    .profile-meta .muted{ font-size:13px; margin-top:4px; }

    /* ‚úÖ Rank label ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡πà‡∏¢‡∏° (‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠/‡∏£‡∏∞‡∏¢‡∏∞/‡πÇ‡∏ó‡∏ô) */
    #profile-rank{ margin-top:8px; }
    #profile-rank-label{
      font-weight: 900;
      letter-spacing: 0.2px;
      color: rgba(15,23,42,0.92);
      background: rgba(255,255,255,0.75);
      border: 1px solid rgba(15,23,42,0.10);
      padding: 6px 10px;
      border-radius: 12px;
      line-height: 1.15;
      max-width: 220px;
      white-space: normal;
      overflow-wrap: anywhere;
    }

    /* ‚úÖ ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥: ‡πÄ‡∏Å‡∏£‡∏î/‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô/‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏° */
    .profile-right{ min-width: 168px; flex: 0 1 200px; }
    .profile-stats{
      display:grid;
      gap:8px;
      padding:10px 12px;
      border-radius:14px;
      border: 1px solid rgba(15,23,42,0.10);
      background: rgba(255,255,255,0.80);
      box-shadow: none;
      max-width: 100%;
    }
    .profile-stats .stat-line{
      font-size:12px;
      font-weight:900;
      color:#0f172a;
      white-space: normal;
      overflow-wrap: anywhere;
    }
    .profile-stats .stat{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      font-size:12px;
      color: rgba(15,23,42,0.70);
      white-space: normal;
      min-width: 0;
    }
    .profile-stats .stat b{
      font-size:14px;
      color:#0f172a;
    }

    /* ‚úÖ ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏à‡∏≠‡πÅ‡∏Ñ‡∏ö: ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏¥‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ‡πÑ‡∏°‡πà‡πÄ‡∏ö‡∏µ‡∏¢‡∏î‡∏Å‡∏±‡∏ô */
    @media (max-width: 420px){
      .profile-left{ flex: 1 1 100%; }
      .profile-right{ min-width: 0; flex: 1 1 100%; }
      .profile-stats{ width: 100%; }
    }
  
    /* ===== Tech UI v2 (Menu Drawer + Clean Profile) ===== */
    .tech-top-tabs{ display:none !important; } /* ISSUE-1: hide duplicated top tabs (keep bottom only) */

    /* Fixed top nav (admin-like) */
    #techTopNav{position:fixed;left:0;right:0;top:0;z-index:2600;
      padding-top:env(safe-area-inset-top);
      background:linear-gradient(180deg, rgba(11,27,58,0.98) 0%, rgba(11,75,179,0.98) 100%);
      border-bottom:1px solid rgba(255,255,255,0.10);
      box-shadow:0 14px 40px rgba(2,6,23,0.22);} 
    #techTopNav .in{max-width:460px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;
      gap:10px;padding:10px 12px;}
    #techTopNav .ttl{min-width:0;display:flex;flex-direction:column;gap:2px}
    #techTopNav .ttl b{font-size:14px;line-height:1.1;color:#fff}
    #techTopNav .ttl span{font-size:12px;font-weight:900;color:rgba(255,255,255,0.80);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .tech-icbtn{width:44px;height:44px;border-radius:16px;display:inline-flex;align-items:center;justify-content:center;
      border:1px solid rgba(255,255,255,0.18);background:rgba(255,255,255,0.12);
      box-shadow:0 10px 26px rgba(0,0,0,0.18);cursor:pointer;user-select:none}
    .tech-icbtn:active{transform: translateY(1px) scale(0.99)}
    #techTopSpacer{height:74px}
    @media (max-width:420px){#techTopSpacer{height:72px}}

    #techDrawerBackdrop{position:fixed;inset:0;background:rgba(2,6,23,0.55);z-index:2690;display:none}
    #techDrawer{position:fixed;inset:0;z-index:2700;display:none}
    #techDrawer .panel{
      position:absolute;right:0;top:0;bottom:0;width:min(360px, 92vw);
      background:rgba(255,255,255,0.98);
      backdrop-filter: blur(10px);
      border-left:1px solid rgba(15,23,42,0.12);
      box-shadow:-18px 0 50px rgba(2,6,23,0.25);
      padding: 12px;
      display:flex;flex-direction:column;gap:10px;
      padding-top: calc(12px + env(safe-area-inset-top));
      padding-bottom: calc(12px + env(safe-area-inset-bottom));
    }
    .techMenuHead{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .techMenuHead b{font-size:14px;font-weight:1100;color:#0f172a}
    .techMenuList{display:flex;flex-direction:column;gap:8px;margin-top:6px}
    .techMenuBtn{
      width:100%;
      min-height:46px;
      border-radius:16px;
      border:1px solid rgba(15,23,42,0.10);
      background:#fff;
      font-weight:1000;
      display:flex;align-items:center;justify-content:space-between;
      padding: 10px 12px;
      cursor:pointer;
    }
    .techMenuBtn .left{display:flex;align-items:center;gap:10px}
    .techMenuBtn .sub{font-size:12px;font-weight:900;color:rgba(15,23,42,0.60)}
    .techMenuDanger{border-color:rgba(239,68,68,0.25);background:rgba(239,68,68,0.08)}
    .techMenuSmall{font-size:12px;font-weight:900;color:rgba(15,23,42,0.70)}

    /* Profile compact (ISSUE-2) */
    .profile-compact{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;}
    .profile-compact .left{display:flex;align-items:center;gap:12px;min-width:0;flex:1 1 240px;}
    .profile-compact .meta{min-width:0}
    .profile-compact .meta .code{font-size:13px;font-weight:1000;color:rgba(15,23,42,0.70)}
    .profile-compact .chips{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;flex:1 1 100%;}
    .chipStat{border-radius:16px;border:1px solid rgba(15,23,42,0.10);background:rgba(255,255,255,0.80);padding:10px;display:flex;flex-direction:column;gap:4px;}
    .chipStat .k{font-size:11px;font-weight:1000;color:rgba(15,23,42,0.60)}
    .chipStat .v{font-size:16px;font-weight:1200;color:#0f172a}
    details.tech-more{margin-top:10px}
    details.tech-more summary{list-style:none;cursor:pointer;user-select:none;border-radius:14px;border:1px solid rgba(15,23,42,0.10);background:rgba(15,23,42,0.04);padding:10px 12px;font-weight:1000;display:flex;align-items:center;justify-content:space-between;gap:10px;}
    details.tech-more summary::-webkit-details-marker{display:none}
    .tech-more .moreBox{margin-top:10px;border-radius:16px;border:1px solid rgba(15,23,42,0.10);background:rgba(255,255,255,0.85);padding:12px;}
    .tech-more .row{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:8px}
    .tech-more .row:first-child{margin-top:0}
    .tech-more .row .k{font-size:12px;font-weight:1000;color:rgba(15,23,42,0.60)}
    .tech-more .row .v{font-size:13px;font-weight:1100;color:#0f172a}
  </style>
</head>

<body>
  <div class="app">
        <!-- ‚úÖ Tech Top Nav (admin-like) -->
    <div id="techTopNav">
      <div class="in">
        <div class="ttl">
          <b>CWF ‚Äì Technician</b>
          <span id="me">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ: -</span>
        </div>
        <button class="tech-icbtn" type="button" id="techMenuBtn" aria-label="‡πÄ‡∏°‡∏ô‡∏π">‚ò∞</button>
      </div>
    </div>
    <div id="techTopSpacer"></div>

    <!-- ‚úÖ Drawer Menu -->
    <div id="techDrawerBackdrop"></div>
    <div id="techDrawer">
      <div class="panel">
        <div class="techMenuHead">
          <b>‡πÄ‡∏°‡∏ô‡∏π‡∏ä‡πà‡∏≤‡∏á</b>
          <button class="tech-icbtn" type="button" id="techMenuCloseBtn" aria-label="‡∏õ‡∏¥‡∏î">‚úï</button>
        </div>

        <div class="techMenuList">
          <!-- keep ids for app.js bindings -->
          <button class="techMenuBtn" type="button" id="notifyBtn">
            <span class="left">üîî <span>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô/‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</span></span>
            <span class="sub" id="notifyStateText">-</span>
          </button>

          <button class="techMenuBtn" type="button" id="themeToggleBtn">
            <span class="left">üé® <span>‡∏™‡∏•‡∏±‡∏ö‡∏ò‡∏µ‡∏°</span></span>
            <span class="sub">Theme</span>
          </button>

          <button class="techMenuBtn" type="button" onclick="goEditProfile()">
            <span class="left">‚úèÔ∏è <span>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</span></span>
            <span class="sub">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡πà‡∏≤‡∏á</span>
          </button>

          <button class="techMenuBtn" type="button" onclick="goChangePassword()">
            <span class="left">üîë <span>‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</span></span>
            <span class="sub">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</span>
          </button>

          <button class="techMenuBtn" type="button" onclick="openWorkdaysModal()">
            <span class="left">üóìÔ∏è <span>‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î/‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</span></span>
            <span class="sub">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
          </button>

          <div class="techMenuSmall" style="margin-top:4px;padding:0 2px;">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</div>

          <button class="techMenuBtn techMenuDanger" type="button" onclick="logout()">
            <span class="left">üö™ <span>‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</span></span>
            <span class="sub">Logout</span>
          </button>
        </div>
      </div>
    </div>


    <!-- ===============================
         üéõÔ∏è ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ä‡πà‡∏≤‡∏á (‡∏™‡∏±‡πâ‡∏ô ‡∏ä‡∏±‡∏î ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á)
         - ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÅ‡∏î‡∏á ‡∏™‡∏•‡∏±‡∏ö‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô/‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô
         - ‡πÇ‡∏ã‡∏ô‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô: dropdown (‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°) ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
         - ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ï‡πâ‡πÅ‡∏ñ‡∏ß‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î
    =============================== -->
    <div class="card tight" style="margin-top:10px;">
      <style>
        /* ‚úÖ ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: ‡∏õ‡∏∏‡πà‡∏° + ‡πÇ‡∏ã‡∏ô ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô */
        .tech-ctrl-row{
          display:flex;
          gap:10px;
          align-items:stretch;
        }
        .tech-ctrl-row > *{
          flex:1;
          min-width:0;
        }

        /* ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô/‡∏´‡∏¢‡∏∏‡∏î‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô: ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡∏ï‡∏•‡∏≠‡∏î */
        .accept-btn{
          width:100%;
          min-height:44px;
          border-radius:14px;
          border:1px solid rgba(15,23,42,0.10);
          font-weight:900;
          font-size:14px;
          display:flex;
          align-items:center;
          justify-content:center;
          gap:8px;
          padding:10px 12px;
          box-shadow:none;
          cursor:pointer;
          user-select:none;
          white-space:nowrap;
        }
        .accept-btn.ready{
          background: rgba(34,197,94,0.18);
          color:#0f172a;
          border-color: rgba(34,197,94,0.35);
        }
        .accept-btn.paused{
          background: rgba(239,68,68,0.18);
          color:#0f172a;
          border-color: rgba(239,68,68,0.35);
        }
        .accept-btn:disabled{
          opacity:0.75;
          cursor:not-allowed;
        }

        /* ‚úÖ dropdown ‡πÇ‡∏ã‡∏ô: ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏° */
        .zone-select{
          width:100%;
          min-height:44px;
          border-radius:14px;
          border:1px solid rgba(15,23,42,0.10);
          padding:10px 12px;
          font-weight:800;
          font-size:14px;
          background:#fff;
        }

        /* ‚úÖ ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏ï‡πâ‡πÅ‡∏ñ‡∏ß */
        .accept-hint{
          margin-top:8px;
          font-size:12px;
          color: rgba(15,23,42,0.65);
        }

        @media (max-width:380px){
          .accept-btn,.zone-select{ font-size:13px; }
        }
      </style>

      <div class="tech-ctrl-row">
        <button id="acceptToggleBtn" class="accept-btn ready" type="button">
          üü¢ ‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô
        </button>

        <select id="zoneSelect" class="zone-select">
          <!-- ‚úÖ ‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡πÇ‡∏ã‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô:" ‡∏≠‡∏≠‡∏Å ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ -->
          <option value="">‡∏ó‡∏∏‡∏Å‡πÇ‡∏ã‡∏ô</option>
          <option value="‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó">‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó</option>
          <option value="‡∏≠‡πà‡∏≠‡∏ô‡∏ô‡∏∏‡∏ä">‡∏≠‡πà‡∏≠‡∏ô‡∏ô‡∏∏‡∏ä</option>
          <option value="‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á">‡∏û‡∏£‡∏∞‡πÇ‡∏Ç‡∏ô‡∏á</option>
          <option value="‡∏ö‡∏≤‡∏á‡∏ô‡∏≤">‡∏ö‡∏≤‡∏á‡∏ô‡∏≤</option>
          <option value="‡∏®‡∏£‡∏µ‡∏ô‡∏Ñ‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå">‡∏®‡∏£‡∏µ‡∏ô‡∏Ñ‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå</option>
          <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
        </select>
      </div>

      <!-- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î -->
      <div id="acceptStatusText" class="accept-hint">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞...</div>

      <!-- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Å‡πà‡∏≤/‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏° (‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏Å) -->
      <select id="acceptStatusSelect" style="display:none;">
        <option value="ready">ready</option>
        <option value="paused">paused</option>
      </select>
      <div id="att-status" style="display:none;"></div>
    </div>

<div class="tabs tech-top-tabs">
      <button class="tab-btn active" id="tab-new" onclick="switchTab('new')">‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
      <button class="tab-btn" id="tab-active" onclick="switchTab('active')">‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</button>
      <button class="tab-btn" id="tab-history" onclick="switchTab('history')">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</button>
    </div>

    <div class="card section active" id="sec-new">
      <h2>üßë‚Äçüîß ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ä‡πà‡∏≤‡∏á</h2>

      <!-- ‚úÖ ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ä‡πà‡∏≤‡∏á (‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞: ‡∏£‡∏π‡∏õ / ‡∏£‡∏´‡∏±‡∏™ / ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ / ‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏° / ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô) -->
      <div class="profile-compact">
        <div class="left">
          <img id="profile-photo" class="tech-avatar" src="/logo.png" alt="photo">
          <div class="meta">
            <div class="code" id="profile-code">‡∏£‡∏´‡∏±‡∏™‡∏ä‡πà‡∏≤‡∏á: -</div>
            <!-- ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏¢‡∏≠‡∏∞ ‡πÜ ‡∏ï‡∏≤‡∏°‡∏™‡πÄ‡∏õ‡∏Ñ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏Ñ‡∏á id ‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ app.js ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤ -->
            <div style="display:none">
              <b id="profile-name">-</b>
              <div id="profile-rank" style="display:flex;align-items:center;gap:8px;">
                <img id="profile-rank-badge" src="/assets/ranks/rank_lv1_128.png" alt="rank" style="width:44px;height:auto;display:block;">
                <div class="muted" id="profile-rank-label">Rank: -</div>
              </div>
              <div class="stat-line" id="profile-grade">‡πÄ‡∏Å‡∏£‡∏î: -</div>
              <div class="muted" id="profile-hint"></div>
            </div>
          </div>
        </div>

        <div class="chips">
          <div class="chipStat">
            <div class="k">üí∞ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
            <div class="v" id="incomeDaily">-</div>
          </div>
          <div class="chipStat">
            <div class="k">‚úÖ ‡∏á‡∏≤‡∏ô‡∏™‡∏∞‡∏™‡∏°</div>
            <div class="v" id="doneCount">-</div>
          </div>
          <div class="chipStat">
            <div class="k">‚≠ê ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
            <div class="v" id="rating">-</div>
          </div>
        </div>
      </div>

      <details class="tech-more">
        <summary>
          <span>‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</span>
          <span>‚ñæ</span>
        </summary>
        <div class="moreBox">
          <div class="row"><span class="k">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á</span><span class="v" id="profile-name-more">-</span></div>
          <div class="row"><span class="k">Rank</span><span class="v" id="profile-rank-more">-</span></div>
          <div class="row"><span class="k">‡πÄ‡∏Å‡∏£‡∏î</span><span class="v" id="profile-grade-more">-</span></div>
          <div class="row"><span class="k">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</span><span class="v" id="incomeMonth">-</span></div>
          <div class="row"><span class="k">‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span><span class="v" id="incomeAll">-</span></div>
        </div>
      </details>

<hr>

      <!-- ‚úÖ ‡∏Å‡∏±‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ã‡πâ‡∏≠‡∏ô ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß -->
      <h2 style="margin-top:6px;">üì® ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 10 ‡∏ô‡∏≤‡∏ó‡∏µ)</h2>
      <div id="offer-list"></div>
    </div>

    <div class="card section" id="sec-active">
      <h2>üß∞ ‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h2>

      <!-- ‚úÖ Sub-tab: ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ / ‡∏á‡∏≤‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°: ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ #active-list ‡πÄ‡∏õ‡πá‡∏ô Today) -->
      <div class="tabs" style="margin-top:10px;gap:10px;">
        <button class="tab-btn active" id="tab-active-today" type="button" onclick="switchActiveSubTab('today')">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
        <button class="tab-btn" id="tab-active-upcoming" type="button" onclick="switchActiveSubTab('upcoming')">‡∏á‡∏≤‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</button>
      </div>

      <div class="section active" id="sec-active-today" style="margin-top:10px;">
        <!-- ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö app.js (Today) -->
        <div id="active-list"></div>
      </div>

      <div class="section" id="sec-active-upcoming" style="margin-top:10px;">
        <div class="muted" style="margin-bottom:6px;">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô ‚Äú‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‚Äù ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</div>
        <!-- ‚úÖ Upcoming -->
        <div id="active-upcoming-list"></div>
      </div>
    </div>

    <div class="card section" id="sec-history">
      <h2>üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</h2>

      <!-- ‚úÖ ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏£‡πá‡∏ß: ‡∏ß‡∏±‡∏ô / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô / ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
      <div class="tabs" style="margin-top:10px;gap:10px;">
        <button class="tab-btn" id="tab-his-day" type="button" onclick="setHistoryFilter('day')">‡∏ß‡∏±‡∏ô</button>
        <button class="tab-btn active" id="tab-his-month" type="button" onclick="setHistoryFilter('month')">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
        <button class="tab-btn" id="tab-his-all" type="button" onclick="setHistoryFilter('all')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
      </div>
      <div class="muted" id="history-filter-hint" style="margin-top:8px;">‡πÅ‡∏™‡∏î‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠</div>

      <!-- ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö app.js -->
      <div id="history-list" style="margin-top:10px;"></div>
    </div>
  </div>

  <!-- ‚úÖ bottom nav ‡∏•‡πá‡∏≠‡∏Ñ -->
  <div class="bottom-nav">
    <button class="nav-btn active" id="nav-new" onclick="switchTab('new')">üè† ‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
    <button class="nav-btn" id="nav-active" onclick="switchTab('active')">üß∞ ‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</button>
    <button class="nav-btn" id="nav-history" onclick="switchTab('history')">üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</button>
  </div>

  <script src="app.js"></script>
  <script>
        function goEditProfile(){ location.href = '/edit-profile.html'; }
        function goChangePassword(){ location.href = '/change-password.html'; }

        function syncTechMore(){
          try{
            const nm = document.getElementById('profile-name');
            const rk = document.getElementById('profile-rank-label');
            const gd = document.getElementById('profile-grade');
            const nm2 = document.getElementById('profile-name-more');
            const rk2 = document.getElementById('profile-rank-more');
            const gd2 = document.getElementById('profile-grade-more');
            if (nm && nm2) nm2.textContent = nm.textContent || '-';
            if (rk && rk2) rk2.textContent = rk.textContent || '-';
            if (gd && gd2) gd2.textContent = gd.textContent || '-';
          }catch(e){}
          try{
            const st = (localStorage.getItem('cwf_notify_enabled') === '1') ? '‡πÄ‡∏õ‡∏¥‡∏î' : '‡∏õ‡∏¥‡∏î';
            const el = document.getElementById('notifyStateText');
            if (el) el.textContent = st;
          }catch(e){}
        }

        function openTechMenu(){
          const bd = document.getElementById('techDrawerBackdrop');
          const dr = document.getElementById('techDrawer');
          if (bd) bd.style.display = 'block';
          if (dr) dr.style.display = 'block';
          syncTechMore();
        }
        function closeTechMenu(){
          const bd = document.getElementById('techDrawerBackdrop');
          const dr = document.getElementById('techDrawer');
          if (bd) bd.style.display = 'none';
          if (dr) dr.style.display = 'none';
        }

        document.addEventListener('DOMContentLoaded', ()=>{
          const btn = document.getElementById('techMenuBtn');
          const cls = document.getElementById('techMenuCloseBtn');
          const bd = document.getElementById('techDrawerBackdrop');
          if (btn) btn.addEventListener('click', openTechMenu);
          if (cls) cls.addEventListener('click', closeTechMenu);
          if (bd) bd.addEventListener('click', closeTechMenu);
          document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape') closeTechMenu(); });
          setTimeout(syncTechMore, 300);
          setTimeout(syncTechMore, 1200);
        });

        window.__cwfSyncTechMore = syncTechMore;


function logout(){
      localStorage.removeItem("username");
      localStorage.removeItem("role");
      try { document.cookie = "cwf_auth=; Max-Age=0; Path=/; SameSite=Lax"; } catch(e) {}
      location.href = "/login.html";
    }

    const TECH_TAB_KEY = "cwf_tech_active_tab";

    function safeKey(k){
      return ["new","active","history"].includes(k) ? k : "new";
    }

    function switchTab(key, opts){
      const k0 = safeKey(key);
      const persist = (opts && opts.persist === false) ? false : true;

      ["new","active","history"].forEach(k=>{
        document.getElementById("sec-"+k).classList.toggle("active", k===k0);
        document.getElementById("tab-"+k).classList.toggle("active", k===k0);
        document.getElementById("nav-"+k).classList.toggle("active", k===k0);
      });

      if (persist) {
        try { localStorage.setItem(TECH_TAB_KEY, k0); } catch(e) {}
        try { location.hash = k0; } catch(e) {}
      }
    }

    // ‚úÖ Sub-tab ‡πÉ‡∏ô ‚Äú‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‚Äù: ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ / ‡∏á‡∏≤‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤
    function switchActiveSubTab(which){
      const w = (which === 'upcoming') ? 'upcoming' : 'today';
      const secT = document.getElementById('sec-active-today');
      const secU = document.getElementById('sec-active-upcoming');
      const btnT = document.getElementById('tab-active-today');
      const btnU = document.getElementById('tab-active-upcoming');
      if (secT) secT.classList.toggle('active', w==='today');
      if (secU) secU.classList.toggle('active', w==='upcoming');
      if (btnT) btnT.classList.toggle('active', w==='today');
      if (btnU) btnU.classList.toggle('active', w==='upcoming');
      try { localStorage.setItem('cwf_tech_active_subtab', w); } catch(e) {}
    }
    window.switchActiveSubTab = switchActiveSubTab;

    // init subtab (default today)
    document.addEventListener('DOMContentLoaded', ()=>{
      let w = 'today';
      try { const s = localStorage.getItem('cwf_tech_active_subtab'); if (s) w = s; } catch(e) {}
      switchActiveSubTab(w);
    });

    // ‚úÖ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ó‡πá‡∏ö‡πÄ‡∏î‡∏¥‡∏° (‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô/‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô)
    document.addEventListener("DOMContentLoaded", () => {
      let initial = "new";
      try {
        const h = (location.hash || "").replace(/^#/, "").trim();
        if (h) initial = h;
      } catch(e) {}

      if (initial === "new") {
        try {
          const saved = localStorage.getItem(TECH_TAB_KEY);
          if (saved) initial = saved;
        } catch(e) {}
      }

      switchTab(initial, { persist: false });
    });
  </script>
</body>
</html>
