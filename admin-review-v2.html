<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Review Queue - CWF</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .app{padding-bottom:86px}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#e2e8f0;font-weight:800;font-size:12px;color:#0f172a}
    .grid{display:grid;grid-template-columns:1fr;gap:10px;margin-top:12px}
    .card{background:#fff;border:1px solid rgba(15,23,42,0.10);border-radius:16px;padding:12px;box-shadow:var(--shadow)}
    .row{display:flex;gap:10px;align-items:center;justify-content:space-between}
    .muted{color:#64748b;font-size:13px}
    .btn{border:none;border-radius:12px;padding:10px 12px;font-weight:800;min-height:44px}
    .btn-primary{background:#22c55e;color:#052e16}
    .btn-ghost{background:#e2e8f0;color:#0f172a}
    .btn-danger{background:#ef4444;color:#fff}
    .btn:disabled{opacity:.5}

    /* bottom nav */
    .bottom-nav{position:fixed;left:0;right:0;bottom:0;background:#0f172a;display:flex;gap:6px;padding:8px;padding-bottom:calc(8px + env(safe-area-inset-bottom));z-index:999;border-top:1px solid rgba(255,255,255,0.08)}
    .nav-btn{flex:1;min-height:44px;border:1px solid rgba(255,255,255,0.18);background:transparent;color:#fff;border-radius:12px;font-weight:800;font-size:13px}
    .nav-btn.active{background:#22c55e;color:#052e16;border-color:transparent}

    /* modal */
    .overlay{position:fixed;inset:0;background:rgba(2,6,23,0.6);display:none;align-items:flex-end;z-index:2000}
    .overlay.show{display:flex}
    .modal{background:#fff;border-radius:18px 18px 0 0;width:100%;max-height:88vh;overflow:auto;padding:14px}
    .modal h3{margin:0 0 6px 0}
    .form{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
    .form input,.form select,.form textarea{width:100%;padding:12px;border-radius:12px;border:1px solid rgba(15,23,42,0.18);font-size:14px}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
    .hr{height:1px;background:rgba(15,23,42,0.10);margin:10px 0}
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;border:1px solid rgba(15,23,42,0.16);background:#f8fafc;font-weight:800;font-size:12px}
    .chip input{width:18px;height:18px}
    .slotbox{display:flex;flex-direction:column;gap:8px;margin-top:8px}
    .slot{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:10px;border-radius:14px;border:1px solid rgba(15,23,42,0.12);background:#fff}
    .slot small{color:#64748b;font-weight:700}
  </style>
</head>
<body class="theme-2">
  <div class="app">
    <div class="topbar">
      <div>
        <h2 style="margin:0">üì• ‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤</h2>
        <div class="muted" style="margin-top:4px">‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚Äú‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö / ‡∏ï‡∏µ‡∏Å‡∏•‡∏±‡∏ö / ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡πà‡∏≤‡∏á‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‚Äù</div>
      </div>
      <div class="pill" id="pillCount">0 ‡∏á‡∏≤‡∏ô</div>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="grid2">
        <select id="filterStatus">
          <option value="pending">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</option>
          <option value="return">‡∏ï‡∏µ‡∏Å‡∏•‡∏±‡∏ö</option>
          <option value="noaccept">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡πà‡∏≤‡∏á‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô</option>
          <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        </select>
        <button class="btn btn-ghost" id="btnReload" type="button">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà</button>
      </div>
      <div class="muted" style="margin-top:8px">* ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: ‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äú‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡∏¢‡∏¥‡∏á‡∏á‡∏≤‡∏ô‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≤‡∏á (‡∏Ñ‡∏¥‡∏î travel buffer ‡πÅ‡∏•‡πâ‡∏ß)</div>
    </div>

    <div class="grid" id="list"></div>
  </div>

  <div class="bottom-nav">
    <button class="nav-btn active" type="button" onclick="location.href='/admin-review-v2.html'">üì• ‡∏á‡∏≤‡∏ô‡∏à‡∏≠‡∏á</button>
    <button class="nav-btn" type="button" onclick="location.href='/admin-add-v2.html'">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
    <button class="nav-btn" type="button" onclick="location.href='/admin-queue-v2.html'">üóìÔ∏è ‡∏Ñ‡∏¥‡∏ß‡∏ä‡πà‡∏≤‡∏á</button>
    <button class="nav-btn" type="button" onclick="location.href='/admin-history-v2.html'">üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
    <button class="nav-btn" type="button" onclick="location.href='/admin-tech.html'">üë∑ ‡∏ä‡πà‡∏≤‡∏á</button>
  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay">
    <div class="modal">
      <div class="row">
        <h3 id="mTitle">‡∏ï‡∏£‡∏ß‡∏à‡∏á‡∏≤‡∏ô</h3>
        <button class="btn btn-ghost" type="button" onclick="closeModal()">‡∏õ‡∏¥‡∏î</button>
      </div>
      <div class="muted" id="mSub"></div>

      <div class="hr"></div>

      <div class="form">
        <div class="grid2">
          <input id="mCustomerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
          <input id="mCustomerPhone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
        </div>
        <div class="grid2">
          <input id="mJobType" placeholder="‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô (‡∏•‡πâ‡∏≤‡∏á/‡∏ã‡πà‡∏≠‡∏°/‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á)">
          <input id="mBookingCode" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô" disabled>
        </div>

        <div class="grid2">
          <input id="mAppt" type="datetime-local">
          <button class="btn btn-ghost" type="button" id="btnLoadSlots">‚è±Ô∏è ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á</button>
        </div>
        <div class="slotbox" id="slotBox" style="display:none"></div>

        <textarea id="mAddress" rows="2" placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà"></textarea>
        <div class="grid2">
          <input id="mMaps" placeholder="Google Maps URL" style="word-break:break-all;overflow-wrap:anywhere">
          <input id="mZone" placeholder="‡πÇ‡∏ã‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
        </div>
        <div class="grid2">
          <input id="mLat" placeholder="Latitude">
          <input id="mLng" placeholder="Longitude">
        </div>
        <textarea id="mNote" rows="2" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô"></textarea>

        <div class="card" style="padding:12px;background:#f8fafc;border-radius:16px;border:1px solid rgba(15,23,42,0.10)">
          <div class="row">
            <b>üë∑ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ä‡πà‡∏≤‡∏á</b>
            <select id="mTechType">
              <option value="company">‡∏ä‡πà‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó (scheduled)</option>
              <option value="partner">‡∏ä‡πà‡∏≤‡∏á‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå (urgent/offer)</option>
            </select>
          </div>
          <div class="grid2" style="margin-top:10px">
            <select id="mPrimaryTech"></select>
            <select id="mDispatchMode">
              <option value="forced">‡∏¢‡∏¥‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≤‡∏á (forced)</option>
              <option value="offer">‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠ (offer)</option>
            </select>
          </div>
          <div class="muted" style="margin-top:8px">* ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô ‡πÉ‡∏´‡πâ‡∏ï‡∏¥‡πä‡∏Å ‚Äú‡∏ä‡πà‡∏≤‡∏á‡∏£‡πà‡∏ß‡∏°‚Äù ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô (‡∏£‡∏ß‡∏° buffer)</div>
          
          <input id="mTeamSearch" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á..." style="margin-top:10px" autocomplete="off">
          <div class="team-picker" style="margin-top:8px">
            <div class="team-suggest" id="mTeamSuggest"></div>
            <div class="team-divider"></div>
            <div class="team-selected-title">‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>
            <div class="team-selected" id="mTeamSelected"></div>
          </div>

        </div>

        <div class="card" style="padding:12px;background:#fff;border-radius:16px;border:1px solid rgba(15,23,42,0.10)">
          <div class="row"><b>üí∞ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏Ñ‡∏≤</b><button class="btn btn-ghost" type="button" id="btnLoadPricing">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button></div>
          <div class="muted" id="mPricing" style="margin-top:8px">-</div>
        </div>

        <div class="grid2">
          <button class="btn btn-ghost" type="button" id="btnSave">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn btn-primary" type="button" id="btnDispatch">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡∏¢‡∏¥‡∏á‡∏á‡∏≤‡∏ô</button>
        </div>
        <button class="btn btn-danger" type="button" id="btnCancel">üóëÔ∏è ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏á‡∏≤‡∏ô</button>
      </div>

      <div style="height:10px"></div>
    </div>
  </div>

  <script src="admin-v2-common.js"></script>
  <script src="admin-review-v2.js"></script>
</body>
</html>
