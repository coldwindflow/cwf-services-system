<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏¥‡∏ß‡∏ä‡πà‡∏≤‡∏á (v2) - CWF</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .app{padding-bottom:86px}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:420px){.grid2{grid-template-columns:1fr}}

    .month-wrap{margin-top:12px;border:1px solid rgba(15,23,42,0.10);border-radius:18px;overflow:hidden;background:#fff;box-shadow:var(--shadow)}
    .month-head{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid rgba(15,23,42,0.08);background:#f8fafc;flex-wrap:wrap}
    .month-head .left{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .month-title{font-weight:900}
    .month-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;padding:12px}
    .dow{font-size:12px;color:rgba(15,23,42,0.65);font-weight:800;text-align:center}
    .day{border:1px solid rgba(15,23,42,0.10);border-radius:16px;padding:10px;display:flex;flex-direction:column;gap:6px;cursor:pointer;overflow:hidden}
    /* square cells (premium calendar) */
    @supports (aspect-ratio: 1 / 1){
      .day{aspect-ratio:1/1;min-height:0}
    }
    @supports not (aspect-ratio: 1 / 1){
      .day{min-height:92px}
    }
    .day.muted{opacity:0.45;cursor:default}
    .day .d{font-weight:900}
    .badge{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px;font-weight:900;line-height:1;max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .badge.full{background:#dc2626;color:#fff}
    .badge.free{background:#16a34a;color:#fff}
    .slots{font-size:12px;color:#fff;font-weight:800;line-height:1.35;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .day.free{background:#16a34a;color:#fff;border-color:rgba(255,255,255,0.22)}
    .day.full{background:#dc2626;color:#fff;border-color:rgba(255,255,255,0.22)}
    .day.neutral{background:#fff;color:#0f172a}

    .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid rgba(15,23,42,0.12);border-radius:999px;padding:6px 10px;background:#fff}
    .pill select,.pill input{border:none;background:transparent;padding:0;margin:0;height:auto}

    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.55);display:none;align-items:flex-end;justify-content:center;z-index:2000;padding:12px;padding-bottom:calc(12px + env(safe-area-inset-bottom))}
    .modal{width:min(720px,100%);background:#fff;border-radius:20px;box-shadow:0 22px 70px rgba(0,0,0,0.25);overflow:hidden;max-height:85vh;display:flex;flex-direction:column}
    .modal-h{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;padding:12px 14px;border-bottom:1px solid rgba(15,23,42,0.10);background:#f8fafc}
    .modal-b{padding:12px 14px;overflow:auto}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .seg{display:flex;gap:8px;flex-wrap:wrap}
    .seg button{min-height:38px;padding:0 12px;border-radius:12px;font-weight:900;border:1px solid rgba(15,23,42,0.14);background:#fff;color:#0f172a}
    .seg button.active{background:#2563eb;color:#fff;border-color:transparent}
    .list{display:flex;flex-direction:column;gap:10px;margin-top:12px}
    .item{border:1px solid rgba(15,23,42,0.10);border-radius:16px;padding:12px;background:#fff;overflow:hidden}
    .item b{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .item .mini{font-size:12px;color:rgba(15,23,42,0.72);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .item .meta{font-size:12px;color:rgba(15,23,42,0.72);margin-top:4px;display:flex;gap:10px;flex-wrap:wrap}

    .bottom-nav{position:fixed;left:0;right:0;bottom:0;background:#0f172a;display:flex;gap:6px;padding:8px;padding-bottom:calc(8px + env(safe-area-inset-bottom));z-index:999;border-top:1px solid rgba(255,255,255,0.08)}
    .nav-btn{flex:1;min-height:44px;border:1px solid rgba(255,255,255,0.18);background:transparent;color:#fff;border-radius:12px;font-weight:700;font-size:13px}
    .nav-btn.active{background:#22c55e;color:#052e16;border-color:transparent}
  </style>
</head>
<body class="theme-2">
  <div class="app">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
      <h2 style="margin:0">üóìÔ∏è ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏¥‡∏ß‡∏ä‡πà‡∏≤‡∏á (‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô)</h2>
      <button class="secondary" type="button" onclick="location.href='/admin.html'">‡πÄ‡∏°‡∏ô‡∏π</button>
    </div>

    <!-- Filter toggle (same UX as History) -->
    <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;margin-top:12px;">
      <button id="btnToggleFilters" class="warning" type="button" style="width:auto;display:flex;align-items:center;gap:8px;">üêß ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</button>
      <div class="muted" style="text-align:right;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ/‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó-‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå</div>
    </div>

    <div class="card" id="filterCard" style="margin-top:10px;display:none">
      <b>‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á</b>
      <div class="grid2" style="margin-top:10px">
        <div class="pill">
          <span style="font-weight:900">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</span>
          <select id="month"></select>
        </div>
        <div class="pill">
          <span style="font-weight:900">‡∏õ‡∏µ</span>
          <select id="year"></select>
        </div>
      </div>

      <div class="grid2" style="margin-top:10px">
        <div>
          <label>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏á‡∏≤‡∏ô (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
          <input id="duration_min" type="number" min="30" step="15" value="30" />
        </div>
        <div>
          <label>‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</label>
          <select id="tech_type">
            <option value="company">‡∏ä‡πà‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
            <option value="partner">‡∏ä‡πà‡∏≤‡∏á‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå</option>
            <option value="all" selected>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
          </select>
        </div>
      </div>
      <button id="btnLoad" class="warning" style="margin-top:10px">‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>
      <div class="muted" style="margin-top:6px">‡πÉ‡∏ä‡πâ logic ‡πÄ‡∏î‡∏¥‡∏° duration + travel buffer (‡πÑ‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô)</div>
    </div>

    <div id="monthCalendar" class="month-wrap" style="display:none">
      <div class="month-head">
        <div class="left">
          <button class="secondary" type="button" id="prevMonth">‚óÄ</button>
          <div>
            <div class="month-title" id="monthTitle">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</div>
            <div class="muted" id="monthSub"></div>
          </div>
          <button class="secondary" type="button" id="nextMonth">‚ñ∂</button>
        </div>
        <button class="secondary" type="button" id="btnReload">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
      </div>

      <div class="month-grid" id="monthGrid">
        <div class="dow">‡∏≠‡∏≤</div><div class="dow">‡∏à</div><div class="dow">‡∏≠</div><div class="dow">‡∏û</div><div class="dow">‡∏û‡∏§</div><div class="dow">‡∏®</div><div class="dow">‡∏™</div>
      </div>
    </div>
  </div>

  <!-- Day detail modal -->
  <div class="modal-backdrop" id="dayModal">
    <div class="modal">
      <div class="modal-h">
        <div>
          <b id="modalTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</b>
          <div class="muted" id="modalSub" style="margin-top:2px"></div>
        </div>
        <button class="secondary btn-small" type="button" id="btnCloseModal">‡∏õ‡∏¥‡∏î</button>
      </div>
      <div class="modal-b">
        <div class="row" style="justify-content:space-between">
          <div class="seg" id="segAvail">
            <button type="button" data-mode="free" class="active">‡∏ä‡πà‡∏≤‡∏á‡∏ß‡πà‡∏≤‡∏á</button>
            <button type="button" data-mode="full">‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°</button>
          </div>
          <div class="seg" id="segType">
            <button type="button" data-type="all" class="active">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <button type="button" data-type="company">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</button>
            <button type="button" data-type="partner">‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå</button>
          </div>
        </div>
        <div class="list" id="modalList"></div>
      </div>
    </div>
  </div>

  <div class="bottom-nav">
    <button class="nav-btn" type="button" onclick="location.href='/admin-review-v2.html'">üì• ‡∏á‡∏≤‡∏ô‡∏à‡∏≠‡∏á</button>
    <button class="nav-btn" type="button" onclick="location.href='/admin-add-v2.html'">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>
    <button class="nav-btn active" type="button" onclick="location.href='/admin-queue-v2.html'">üóìÔ∏è ‡∏Ñ‡∏¥‡∏ß‡∏ä‡πà‡∏≤‡∏á</button>
    <button class="nav-btn" type="button" onclick="location.href='/admin-history-v2.html'">üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
    <button class="nav-btn" type="button" onclick="location.href='/admin-tech.html'">üë∑ ‡∏ä‡πà‡∏≤‡∏á</button>
  </div>

  <script src="admin-v2-common.js"></script>
  <script src="admin-queue-v2.js"></script>
</body>
</html>
