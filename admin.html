<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - CWF</title>

  <!-- CSS ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö -->
  <link rel="stylesheet" href="style.css">

  <style>
    /* ‚úÖ ‡∏à‡∏±‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏° */
    .section-card{ margin-top:12px; }
    .section-card h3{ margin:0 0 10px; }

    /* ‚úÖ Modal (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ö‡∏á‡∏≤‡∏ô) */
    .modal-backdrop{
      position: fixed; inset: 0;
      background: rgba(2,6,23,0.55);
      display:none; align-items:center; justify-content:center;
      z-index: 2000;
      padding: 12px;
      padding-bottom: calc(12px + env(safe-area-inset-bottom));
      overscroll-behavior: contain;
    }
    body.modal-open{ overflow:hidden; }
    .modal-backdrop.show{ display:flex; }
    .modal{
      /* ‚úÖ ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡πÅ‡∏≠‡∏û ‡∏•‡∏î‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ "‡∏´‡∏•‡∏∏‡∏î‡πÄ‡∏ü‡∏£‡∏°" ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡∏à‡∏≠‡πÅ‡∏Ñ‡∏ö */
      width: min(460px, calc(100% - 28px));
      box-sizing: border-box;
      background:#fff;
      border-radius: 18px;
      border: 1px solid rgba(15,23,42,0.12);
      box-shadow: var(--shadow);
      padding: 14px;
      max-height: calc(100vh - 24px - env(safe-area-inset-bottom));
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      contain: layout paint;
    }
    .modal .modal-head{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      margin-bottom: 8px;
    }
    .modal .modal-head b{ font-size:18px; }
    .modal .grid2{ display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
    @media (max-width:420px){
      .modal .grid2{ grid-template-columns: 1fr; }
    }
    .btn-row{ display:flex; gap:10px; margin-top:12px; }
    .btn-row button{ flex:1; }
    .btn-mini{ width:auto; min-height:40px; padding:10px 12px; }
  </style>
</head>
<body class="theme-2">

  <div class="app">
    <h2>üë®‚Äçüíº Admin - CWF</h2>

    <div class="row" style="margin:10px 0 6px;">
      <button class="secondary" type="button" onclick="location.href='/admin-tech.html'">üë∑ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≤‡∏á / ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</button>
      <button class="danger" type="button" onclick="logoutAdmin()">‡∏≠‡∏≠‡∏Å</button>
    </div>


    <!-- ===============================
         üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡∏á‡∏≤‡∏ô
         ‚úÖ ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: job_type ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á constraint ‡πÉ‡∏ô DB
         ‡∏Ñ‡∏∑‡∏≠ "‡∏•‡πâ‡∏≤‡∏á" | "‡∏ã‡πà‡∏≠‡∏°" | "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á" ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
    =============================== -->
    <div class="card section-card" id="adminBookV2">
    <h3>üóìÔ∏è ‡∏à‡∏≠‡∏á‡∏á‡∏≤‡∏ô (Admin v2) ‚Äî Flow ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 100%</h3>

    <div class="muted" style="margin-top:6px;">
      ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô ‚Üí ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏≠‡∏£‡πå ‚Üí BTU ‚Üí ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‚Üí ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì <b>‡∏£‡∏≤‡∏Ñ‡∏≤/‡πÄ‡∏ß‡∏•‡∏≤</b> ‡πÉ‡∏´‡πâ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ + ‡∏ä‡πà‡∏≤‡∏á
    </div>

    <label style="margin-top:12px;">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô</label>
    <select id="v2_job_type">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô --</option>
      <option value="‡∏•‡πâ‡∏≤‡∏á">‡∏•‡πâ‡∏≤‡∏á</option>
      <option value="‡∏ã‡πà‡∏≠‡∏°">‡∏ã‡πà‡∏≠‡∏°</option>
      <option value="‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</option>
    </select>

    <div class="grid2" style="margin-top:10px;">
      <div>
        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÅ‡∏≠‡∏£‡πå</label>
        <select id="v2_ac_type">
          <option value="‡∏ú‡∏ô‡∏±‡∏á">‡∏ú‡∏ô‡∏±‡∏á</option>
          <option value="‡∏™‡∏µ‡πà‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á">‡∏™‡∏µ‡πà‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á</option>
          <option value="‡πÅ‡∏Ç‡∏ß‡∏ô">‡πÅ‡∏Ç‡∏ß‡∏ô</option>
          <option value="‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏¢‡πÉ‡∏ï‡πâ‡∏ù‡πâ‡∏≤">‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏¢‡πÉ‡∏ï‡πâ‡∏ù‡πâ‡∏≤</option>
        </select>
      </div>
      <div>
        <label>BTU</label>
        <input id="v2_btu" type="number" min="0" step="1000" placeholder="‡πÄ‡∏ä‡πà‡∏ô 12000">
      </div>
    </div>

    <div class="grid2" style="margin-top:10px;">
      <div>
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á</label>
        <input id="v2_machine_count" type="number" min="1" step="1" value="1">
      </div>
      <div>
        <label>‡πÇ‡∏´‡∏°‡∏î‡∏à‡∏≠‡∏á</label>
        <select id="v2_booking_mode">
          <option value="scheduled">‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏ô‡∏±‡∏î‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô)</option>
          <option value="urgent">‡∏•‡∏≠‡∏á‡∏¢‡∏¥‡∏á‡∏á‡∏≤‡∏ô‡∏î‡πà‡∏ß‡∏ô (‡∏£‡∏≠‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô)</option>
        </select>
      </div>
    </div>

    <div id="v2_variant_box" style="margin-top:10px;"></div>

    <div class="card" style="margin-top:12px;background:#f8fafc;border:1px solid rgba(15,23,42,0.08);">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;">
        <b>üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤/‡πÄ‡∏ß‡∏•‡∏≤ (‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</b>
        <button type="button" class="secondary" style="width:auto;min-height:40px;padding:10px 12px;" onclick="adminV2Preview()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
      </div>
      <div class="grid2" style="margin-top:10px;">
        <div>
          <div class="muted">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</div>
          <div><b><span id="v2_price">-</span></b> ‡∏ö‡∏≤‡∏ó</div>
        </div>
        <div>
          <div class="muted">‡πÄ‡∏ß‡∏•‡∏≤ (duration)</div>
          <div><b><span id="v2_duration">-</span></b> ‡∏ô‡∏≤‡∏ó‡∏µ (+ buffer 30 ‡∏ô‡∏≤‡∏ó‡∏µ)</div>
        </div>
      </div>

      <hr style="margin:12px 0;">

      <div class="grid2">
        <div>
          <label>Override ‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)</label>
          <input id="v2_override_price" type="number" min="0" step="1" placeholder="‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á = ‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô">
        </div>
        <div>
          <label>Override ‡πÄ‡∏ß‡∏•‡∏≤ (‡∏ô‡∏≤‡∏ó‡∏µ) (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)</label>
          <input id="v2_override_duration" type="number" min="0" step="5" placeholder="‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á = ‡πÉ‡∏ä‡πâ‡∏ï‡∏≤‡∏°‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤">
        </div>
      </div>
      <div class="muted" style="margin-top:6px;">
        * ‡∏á‡∏≤‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á/‡∏ã‡πà‡∏≠‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏ override ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏à‡∏≠‡∏á
      </div>
    </div>

    <hr>

    <h3 style="margin-top:10px;">üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h3>
    <input id="v2_customer_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
    <input id="v2_customer_phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">
    <input id="v2_address_text" placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà">

    <h3 style="margin-top:16px;">üìç ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô (GPS)</h3>
    <input id="v2_maps_link" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Google Maps (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
    <button type="button" onclick="adminV2ParseMapsLink()">‡πÅ‡∏¢‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
    <div style="display:flex; gap:8px; margin-top:8px;">
      <input id="v2_gps_latitude" placeholder="Latitude">
      <input id="v2_gps_longitude" placeholder="Longitude">
    </div>

    <hr>

    <h3 style="margin-top:10px;">üìÖ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ + ‡∏ä‡πà‡∏≤‡∏á</h3>
    <input id="v2_appointment_datetime" type="datetime-local">

    <div class="grid2" style="margin-top:10px;">
      <div>
        <label>‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ä‡πà‡∏≤‡∏á</label>
        <select id="v2_tech_type">
          <option value="company">‡∏ä‡πà‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
          <option value="partner">‡∏ä‡πà‡∏≤‡∏á‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå</option>
        </select>
      </div>
      <div>
        <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô</label>
        <select id="v2_dispatch_mode">
          <option value="forced">Forced (‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)</option>
          <option value="offer">Offer (‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≤‡∏á‡∏Å‡∏î‡∏£‡∏±‡∏ö)</option>
        </select>
      </div>
    </div>

    <div class="row" style="margin-top:10px;gap:10px;flex-wrap:wrap;">
      <button class="secondary" type="button" style="width:auto;" onclick="adminV2LoadSlots()">‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏¥‡∏ß‡∏ß‡πà‡∏≤‡∏á (v2)</button>
      <div class="muted" id="v2_slot_hint">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤/‡πÄ‡∏ß‡∏•‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏¥‡∏ß‡∏ß‡πà‡∏≤‡∏á</div>
    </div>
    <div id="v2_slots" class="muted" style="margin-top:10px;">-</div>

    <label style="margin-top:12px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≤‡∏á (‡∏ñ‡πâ‡∏≤‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≤‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</label>
    <select id="v2_technician_username">
      <option value="">-- auto --</option>
    </select>

    <label style="margin-top:10px;">üë• ‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô)</label>
    <select id="v2_team_usernames" multiple style="width:100%;min-height:92px;">
      <!-- ‡πÄ‡∏ï‡∏¥‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS ‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏≤‡∏á -->
    </select>

    <textarea id="v2_customer_note" rows="3" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" style="width:100%;margin-top:10px;"></textarea>

    <button style="margin-top:12px;" onclick="adminV2Book()">‚úÖ ‡∏à‡∏≠‡∏á‡∏á‡∏≤‡∏ô (Admin v2)</button>

    <!-- ‚úÖ Legacy UI ‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ (‡∏Å‡∏±‡∏ô‡∏á‡∏á) ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢ ?legacy=1 -->
    <div id="legacyAddJobContainer" style="display:none;margin-top:12px;">
      <div class="card" style="background:#fff7ed;border:1px solid rgba(234,88,12,0.25);">
        <b>üß© ‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏Å‡πà‡∏≤ (legacy)</b>
        <div class="muted" style="margin-top:6px;">* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏±‡∏ô‡∏á‡∏á (‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢ ?legacy=1) ‚Äî ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Admin v2 ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô</div>
      </div>

    <input id="customer_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
    <input id="customer_phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">

    <!-- ‚úÖ ‡∏Å‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏á: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô dropdown -->
    <select id="job_type">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô --</option>
      <option value="‡∏•‡πâ‡∏≤‡∏á">‡∏•‡πâ‡∏≤‡∏á</option>
      <option value="‡∏ã‡πà‡∏≠‡∏°">‡∏ã‡πà‡∏≠‡∏°</option>
      <option value="‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</option>
    </select>

    <!-- ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏ó‡∏¢‡πÉ‡∏ô UI (datetime-local) -->
    <input id="appointment_datetime" type="datetime-local">

    <input id="address_text" placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà">

    <!-- ===============================
         üìç ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô GPS)
         - ‡πÉ‡∏™‡πà‡πÑ‡∏î‡πâ 2 ‡πÅ‡∏ö‡∏ö: ‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Maps ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÅ‡∏¢‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î / ‡∏Å‡∏£‡∏≠‡∏Å lat,lng ‡πÄ‡∏≠‡∏á
         - lat,lng ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á jobs.gps_latitude / jobs.gps_longitude
    =============================== -->
    <h3 style="margin-top:16px;">üìç ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô (GPS)</h3>

    <input id="maps_link" placeholder="‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Google Maps (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
    <button type="button" onclick="parseMapsLink()">‡πÅ‡∏¢‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>

    <div style="display:flex; gap:8px; margin-top:8px;">
      <input id="gps_latitude" placeholder="Latitude ‡πÄ‡∏ä‡πà‡∏ô 13.7051234">
      <input id="gps_longitude" placeholder="Longitude ‡πÄ‡∏ä‡πà‡∏ô 100.6012345">
    </div>
    <small>‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô (‡∏≠‡∏ô‡∏∏‡πÇ‡∏•‡∏°‡∏Ñ‡∏•‡∏≤‡∏î‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô ¬±500 ‡πÄ‡∏°‡∏ï‡∏£)</small>

    <!-- ‚úÖ ‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°: ‡∏¢‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏û‡∏±‡∏á (‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) -->
    <input id="job_price" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏Å‡πà‡∏≤/‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ)">

    <!-- ===============================
         üë∑ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≤‡∏á (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å)
    =============================== -->
    <select id="technician_username">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≤‡∏á --</option>
    </select>

    <!-- ===============================
         üö¶ ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≤‡∏á
         - offer: ‡∏ä‡πà‡∏≤‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏£‡∏±‡∏ö‡∏Å‡πà‡∏≠‡∏ô (‡πÄ‡∏î‡∏¥‡∏°)
         - forced: ‡∏á‡∏≤‡∏ô‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö ‡πÇ‡∏ú‡∏•‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏£‡∏±‡∏ö)
    =============================== -->
    <select id="dispatch_mode">
      <option value="offer">üì® Offer (‡∏ä‡πà‡∏≤‡∏á‡∏Å‡∏î‡∏£‡∏±‡∏ö)</option>
      <option value="forced">üìå Forced (‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô)</option>
    </select>

    <hr>

    <!-- ===============================
         üí∞ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
    =============================== -->
    <h3>üßæ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h3>

    <select id="catalog_select">
      <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ --</option>
    </select>

    <input id="item_qty" type="number" step="1" min="1" value="1" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô">
    <button type="button" onclick="addItemToJob()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>

    <div id="job_items_preview" style="margin-top:10px;"></div>

    <!-- ===============================
         üéÅ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô (‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏ö‡∏¥‡∏•)
    =============================== -->
    <h3 style="margin-top:16px;">üéÅ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô (‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏ö‡∏¥‡∏•)</h3>
    <select id="promotion_select">
      <option value="">-- ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£ --</option>
    </select>

    <p style="margin-top:10px;">
      üíµ <b>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:</b> <span id="grand_total">0</span> ‡∏ö‡∏≤‡∏ó
    </p>

    <!-- ===============================
         ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
    =============================== -->
    <button onclick="addJob()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</button>

    </div><!-- /legacyAddJobContainer -->

    </div> <!-- legacyAddJobContainer -->

    </div>

    <hr>

    <!-- ===============================
         üì© ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏±‡∏î (‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏™‡πà‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)
    =============================== -->
    <details class="card section-card" open>
      <summary style="font-weight:800;">üì© ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏±‡∏î (‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏™‡πà‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</summary>
      <div style="margin-top:10px;">
        <textarea id="summary_text" rows="12" style="width:100%;"></textarea>
        <button type="button" onclick="copySummary()">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
      </div>
    </details>

    <hr>

    <!-- ===============================
         ‚öôÔ∏è Admin ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏£‡∏≤‡∏Ñ‡∏≤ + ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£
    =============================== -->
    <details class="card section-card">
      <summary style="font-weight:800;">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏£‡∏≤‡∏Ñ‡∏≤ + ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô)</summary>
      <div style="margin-top:10px;">
        <h3>‚öôÔ∏è ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏£‡∏≤‡∏Ñ‡∏≤ (Admin)</h3>
        <input id="new_item_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏£‡πå‡∏ú‡∏ô‡∏±‡∏á (‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏Å‡∏ï‡∏¥)">
        <select id="new_item_category">
          <option value="service">service (‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£)</option>
          <option value="product">product (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)</option>
        </select>
        <input id="new_item_price" type="number" step="0.01" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤">
        <input id="new_item_unit" placeholder="‡∏´‡∏ô‡πà‡∏ß‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á/‡∏ä‡∏¥‡πâ‡∏ô/‡∏á‡∏≤‡∏ô" value="‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á">
        <button type="button" onclick="createCatalogItem()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>

        <h3 style="margin-top:16px;">üéÅ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô (Admin)</h3>
        <input id="new_promo_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£ ‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏î 10%">
        <input id="new_promo_value" type="number" step="0.01" placeholder="‡∏Ñ‡πà‡∏≤‡πÇ‡∏õ‡∏£ ‡πÄ‡∏ä‡πà‡∏ô 5 / 10 / 15">
        <button type="button" onclick="createPromotion()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏õ‡∏£</button>
      </div>
    </details>

    <hr>

    <a href="/tech.html">‡∏î‡∏π‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡πà‡∏≤‡∏á</a>
  
    <hr style="margin:16px 0;">

    <!-- ===============================
         üì• ‡∏á‡∏≤‡∏ô‡∏à‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢)
         - ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏à‡∏≠‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô job_source='customer'
         - ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏ä‡πà‡∏≤‡∏á (offer/forced) ‡∏Å‡πà‡∏≠‡∏ô
    =============================== -->
    
    <div class="card" style="margin-top:12px;">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;">
        <h2 style="margin:0;">üóìÔ∏è ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Ñ‡∏¥‡∏ß‡∏ä‡πà‡∏≤‡∏á (v2)</h2>
        <button type="button" class="secondary" style="width:auto;min-height:40px;padding:10px 12px;" onclick="adminLoadScheduleV2()">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</button>
      </div>

      <div class="grid2" style="margin-top:10px;">
        <input id="av2_date" type="date">
        <select id="av2_tech_type">
          <option value="company">‡∏ä‡πà‡∏≤‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
          <option value="partner">‡∏ä‡πà‡∏≤‡∏á‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÄ‡∏ô‡∏≠‡∏£‡πå</option>
        </select>
      </div>

      <div class="muted" style="margin-top:8px;">‡πÅ‡∏™‡∏î‡∏á‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡πà‡∏≤‡∏á (‡∏Ñ‡∏¥‡∏î buffer 30 ‡∏ô‡∏≤‡∏ó‡∏µ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ö‡∏•‡πá‡∏≠‡∏Å)</div>
      <div id="admin_schedule" class="muted" style="margin-top:10px;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡πÇ‡∏´‡∏•‡∏î</div>

      <details style="margin-top:12px;">
        <summary style="font-weight:800;">‡∏î‡∏π ‚Äú‡∏Ñ‡∏¥‡∏ß‡∏ß‡πà‡∏≤‡∏á‚Äù ‡πÅ‡∏ö‡∏ö‡∏™‡∏•‡πá‡∏≠‡∏ï (availability)</summary>
        <div class="grid2" style="margin-top:10px;">
          <input id="av2_duration" type="number" min="15" step="5" value="60" placeholder="duration_min">
          <button type="button" class="secondary" onclick="adminLoadAvailabilityV2()">‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏¥‡∏ß‡∏ß‡πà‡∏≤‡∏á</button>
        </div>
        <div id="av2_result" class="muted" style="margin-top:10px;">-</div>
      </details>
    </div>

<div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;">
        <h3 style="margin:0;">üì• ‡∏á‡∏≤‡∏ô‡∏à‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏≠‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢)</h3>
        <button class="secondary" style="width:auto;min-height:40px;padding:10px 12px;" type="button" onclick="loadCustomerBookings()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
      </div>
      <div id="customerBookings" class="muted" style="margin-top:10px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
    </div>
    
    <!-- ===============================
         üìö ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Admin)
         - ‡πÅ‡∏¢‡∏Å: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ / ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô / ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å / ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÄ‡∏•‡∏ó
         - ‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à/‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏¢‡πâ‡∏≤‡∏¢‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ù‡∏±‡πà‡∏á‡∏ä‡πà‡∏≤‡∏á)
    =============================== -->
    <div class="card" style="margin-top:14px;">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;">
        <h3 style="margin:0;">üìö ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
          <select id="allJobsFilter" style="min-height:40px;">
            <option value="running">üõ†Ô∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
            <option value="done">‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</option>
            <option value="canceled">‚õî ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</option>
            <option value="late">‚è∞ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô‡πÄ‡∏•‡∏ó</option>
            <option value="all">üìÑ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
          </select>
          <button class="secondary" style="width:auto;min-height:40px;padding:10px 12px;" type="button" onclick="loadAllJobs()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
        </div>
      </div>
      <div id="allJobs" class="muted" style="margin-top:10px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
    </div>

    <!-- ===============================
         üß© Modal: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ö‡∏á‡∏≤‡∏ô (‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
         - ‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏¢‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏≤‡∏Å URL Maps
    =============================== -->
    <div id="editModalBackdrop" class="modal-backdrop" onclick="if(event.target.id==='editModalBackdrop') closeEditModal();">
      <div class="modal" role="dialog" aria-modal="true">
        <div class="modal-head">
          <div>
            <b id="editModalTitle">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ö‡∏á‡∏≤‡∏ô</b>
            <div class="muted" id="editModalSub" style="margin-top:2px;font-size:12px;">-</div>
          </div>
          <button class="danger btn-mini" type="button" onclick="closeEditModal()">‡∏õ‡∏¥‡∏î</button>
        </div>

        <input id="edit_customer_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤">
        <input id="edit_customer_phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">

        <select id="edit_job_type">
          <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô --</option>
          <option value="‡∏•‡πâ‡∏≤‡∏á">‡∏•‡πâ‡∏≤‡∏á</option>
          <option value="‡∏ã‡πà‡∏≠‡∏°">‡∏ã‡πà‡∏≠‡∏°</option>
          <option value="‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á">‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</option>
        </select>

        <input id="edit_appointment_datetime" type="datetime-local">
        <input id="edit_address_text" placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà">

        <input id="edit_maps_url" placeholder="‡∏•‡∏¥‡∏á‡∏Å‡πå Google Maps (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
        <div class="row" style="margin-top:8px;">
          <button class="secondary" type="button" style="width:auto;" onclick="parseMapsToLatLngInModal()">üìç ‡πÅ‡∏¢‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
        </div>

        <div class="grid2" style="margin-top:8px;">
          <input id="edit_gps_latitude" placeholder="Latitude (‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ)">
          <input id="edit_gps_longitude" placeholder="Longitude (‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ)">
        </div>

        <input id="edit_job_zone" placeholder="‡πÇ‡∏ã‡∏ô‡∏á‡∏≤‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
        <textarea id="edit_customer_note" rows="3" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" style="width:100%;"></textarea>

        <hr style="margin:12px 0;">

        <!-- ‚úÖ ‡∏ï‡πà‡∏≠‡πÄ‡∏ï‡∏¥‡∏°: ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á (‡πÉ‡∏ä‡πâ Booking ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô) -->
        <b>üë• ‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á (‡πÉ‡∏ä‡πâ Booking ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô)</b>
        <div class="muted" style="margin-top:4px;">‡πÉ‡∏™‡πà username ‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ , ‡πÄ‡∏ä‡πà‡∏ô <b>tech1,tech2</b> (‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ)</div>
        <input id="edit_team_members" placeholder="‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á (username,... )" style="margin-top:8px;">
        <div class="row" style="margin-top:8px;gap:10px;flex-wrap:wrap;">
          <button class="secondary" type="button" style="width:auto;" onclick="saveTeamMembersFromModal()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏≤‡∏á</button>
          <div id="edit_team_status" class="muted"></div>
        </div>

        <hr style="margin:12px 0;">

        <!-- ‚úÖ ‡∏ï‡πà‡∏≠‡πÄ‡∏ï‡∏¥‡∏°: ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏£‡∏≤‡∏Ñ‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
        <b>üßæ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏£‡∏≤‡∏Ñ‡∏≤ (‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ)</b>
        <div class="muted" style="margin-top:4px;">‡πÉ‡∏ä‡πâ‡πÅ‡∏Å‡πâ‡πÄ‡∏Ñ‡∏™ ‚Äú‡∏•‡∏á‡∏á‡∏≤‡∏ô‡∏ú‡∏¥‡∏î/‡πÅ‡∏Å‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤/‡πÅ‡∏Å‡πâ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‚Äù (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ workflow)</div>

        <div class="grid2" style="margin-top:10px;">
          <select id="edit_catalog_select"></select>
          <input id="edit_item_qty" type="number" min="1" step="1" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" value="1">
        </div>
        <div class="grid2" style="margin-top:8px;">
          <input id="edit_item_unit_price" type="number" min="0" step="1" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢">
          <button class="secondary" type="button" style="width:auto;" onclick="addEditItem()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
        </div>

        <div id="edit_items_preview" class="muted" style="margin-top:10px;">(‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</div>

        <select id="edit_promotion_select" style="margin-top:10px;"></select>
        <div class="row" style="margin-top:8px;gap:10px;flex-wrap:wrap;">
          <button class="secondary" type="button" style="width:auto;" onclick="saveEditItems()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏£‡∏≤‡∏Ñ‡∏≤</button>
          <div id="edit_items_status" class="muted"></div>
        </div>

        <div class="btn-row">
          <button id="editSaveBtn" type="button" onclick="saveEditModal()">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
          <button class="danger" type="button" style="width:auto;" onclick="hardDeleteJobFromModal()">üóëÔ∏è ‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£</button>
          <button class="secondary" type="button" onclick="closeEditModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
        </div>
      </div>
    </div>


</div>

  <script src="admin.js"></script>

<script>
  function logoutAdmin(){
    localStorage.removeItem("username");
    localStorage.removeItem("role");
    // clear cookie fallback
    try { document.cookie = "cwf_auth=; Max-Age=0; Path=/; SameSite=Lax"; } catch(e) {}
    location.href = "/login.html";
  }
</script>
</body>
</html>
